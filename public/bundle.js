(()=>{"use strict";function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t,i=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var i,n,a;return i=t,n=[{key:"init",value:function(e){this.initMovement(e)}},{key:"initMovement",value:function(e){var t=0,i=0,n=0,a=0;document.addEventListener("keydown",(function(r){switch(r.key){case"a":t=-1;break;case"d":i=1;break;case"w":n=-1;break;case"s":a=1}e.emit("velocityChange",{x:t+i,y:n+a})})),document.addEventListener("keyup",(function(r){switch(r.key){case"a":t=0;break;case"d":i=0;break;case"w":n=0;break;case"s":a=0}e.emit("velocityChange",{x:t+i,y:n+a})}))}}],a=[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}],n&&e(i.prototype,n),a&&e(i,a),t}();function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}!function(e){e.BgColor="#231f20",e.FloorColor="#93c09e",e.PlayerColor="#006a4e",e.PlayersColor="#136185",e.ItemColor="#e66916",e.NameColor="#F0FFF0"}(t||(t={}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var i,a,r;return i=e,r=[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}],(a=[{key:"init",value:function(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.height=.75*window.innerHeight,this.canvas.width=.75*window.innerWidth}},{key:"renderGame",value:function(e){this.renderWorld(e);var t=this.renderPlayer(e),i=t.playerX,n=t.playerY;this.renderPlayers(e,i,n),this.renderItems(e,i,n)}},{key:"renderWorld",value:function(e){this.ctx.fillStyle=t.BgColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=t.FloorColor,this.ctx.fillRect(0,0,e.map.mapWidth*e.gridSize,e.map.mapHeight*e.gridSize)}},{key:"renderPlayer",value:function(e){var i,n,a=e.player,r=Math.ceil(this.canvas.width/e.gridSize),s=Math.ceil(this.canvas.height/e.gridSize);i=a.pos.x<=r/2?a.pos.x*e.gridSize:a.pos.x>=e.map.mapWidth-r/2?this.canvas.width-(e.map.mapWidth-a.pos.x)*e.gridSize:this.canvas.width/2,n=a.pos.y<=s/2?a.pos.y*e.gridSize:a.pos.y>=e.map.mapHeight-s/2?this.canvas.height-(e.map.mapHeight-a.pos.y)*e.gridSize:this.canvas.height/2,this.ctx.fillStyle=t.NameColor,this.ctx.font="25px Arial";var c=this.ctx.measureText(a.name).width;return this.ctx.fillText(a.name,i-c/2+e.gridSize/2,n-e.gridSize/2),this.ctx.fillStyle=t.PlayerColor,this.ctx.fillRect(i,n,e.gridSize,e.gridSize),{playerX:i,playerY:n}}},{key:"renderPlayers",value:function(e,i,n){var a=this,r=Math.ceil(this.canvas.width/e.gridSize),s=Math.ceil(this.canvas.height/e.gridSize);e.players.forEach((function(c){var o=c.pos.x-e.player.pos.x,l=c.pos.y-e.player.pos.y;if(Math.abs(o)<r&&Math.abs(l)<s){a.ctx.fillStyle=t.NameColor,a.ctx.font="25px Arial";var h=a.ctx.measureText(c.name).width;a.ctx.fillText(c.name,i+o*e.gridSize-h/2+e.gridSize/2,n+l*e.gridSize-e.gridSize/2),a.ctx.fillStyle=t.PlayersColor,a.ctx.fillRect(i+o*e.gridSize,n+l*e.gridSize,e.gridSize,e.gridSize)}}))}},{key:"renderItems",value:function(e,i,n){var a=this,r=Math.ceil(this.canvas.width/e.gridSize),s=Math.ceil(this.canvas.height/e.gridSize);e.items.forEach((function(c){var o=c.pos.x-e.player.pos.x,l=c.pos.y-e.player.pos.y;Math.abs(o)<r&&Math.abs(l)<s&&(a.ctx.fillStyle=t.ItemColor,a.ctx.fillRect(i+o*e.gridSize,n+l*e.gridSize,e.gridSize,e.gridSize))}))}}])&&n(i.prototype,a),r&&n(i,r),e}(),r=io("/"),s=document.getElementById("game-screen"),c=document.getElementById("form-screen"),o=document.getElementById("username-input");document.getElementById("nickname-form").addEventListener("submit",(function(e){e.preventDefault(),r.emit("playerInit","".concat(o.value)),c.style.display="none",s.style.display="block",new Promise((function(e){r.on("playerAdded",(function(){return e(!0)}))})).then((function(){return e=a.getInstance(),t=i.getInstance(),r.on("gameState",(function(t){var i=JSON.parse(t);requestAnimationFrame((function(){return e.renderGame(i)}))})),t.init(r),void e.init();var e,t}))}))})();
//# sourceMappingURL=bundle.js.map