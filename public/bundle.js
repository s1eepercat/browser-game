(()=>{var e={531:e=>{e.exports={PlayerSpeed:1,VisibilityDistanceX:48,VisibilityDistanceY:21,FrameRate:30,GridSize:30,MapWidth:140,MapHeight:140,SpawnX:3,SpawnY:3,SpawnLength:10,ItemAmountPerPlayer:10,CrawlersPerPlayer:10,CrawlersSpawnDistance:25}}},t={};function i(a){var r=t[a];if(void 0!==r)return r.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,i),n.exports}(()=>{"use strict";function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var t,a=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var i,a,r;return i=t,a=[{key:"init",value:function(e){this.initMovement(e)}},{key:"initMovement",value:function(e){var t=0,i=0,a=0,r=0;document.addEventListener("keydown",(function(n){switch(n.key){case"a":t=-1;break;case"d":i=1;break;case"w":a=-1;break;case"s":r=1}e.emit("velocityChange",{x:t+i,y:a+r})})),document.addEventListener("keyup",(function(n){switch(n.key){case"a":t=0;break;case"d":i=0;break;case"w":a=0;break;case"s":r=0}e.emit("velocityChange",{x:t+i,y:a+r})}))}}],r=[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}],a&&e(i.prototype,a),r&&e(i,r),t}(),r=i(531);function n(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}!function(e){e.BgColor="#231f20",e.FloorColor="#93c09e",e.SpawnColor="#767676",e.PlayerColor="#006a4e",e.PlayersColor="#136185",e.ItemColor="#e66916",e.NameColor="#F0FFF0",e.CrawlerColor="#AA4A44"}(t||(t={}));var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var i,a,s;return i=e,s=[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}],(a=[{key:"init",value:function(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.height=.75*window.innerHeight,this.canvas.width=.75*window.innerWidth}},{key:"renderGame",value:function(e){var t=this.getPlayerPosition(e),i=t.playerX,a=t.playerY;this.renderWorld(e),this.renderSpawn(e,i,a),this.renderPlayer(e,i,a),this.renderPlayers(e,i,a),this.renderCrawlers(e,i,a),this.renderItems(e,i,a)}},{key:"getPlayerPosition",value:function(e){var t=e.player,i=Math.ceil(this.canvas.width/e.gridSize),a=Math.ceil(this.canvas.height/e.gridSize);return{playerX:t.pos.x<=i/2?t.pos.x*e.gridSize:t.pos.x>=e.map.mapWidth-i/2?this.canvas.width-(e.map.mapWidth-t.pos.x)*e.gridSize:this.canvas.width/2,playerY:t.pos.y<=a/2?t.pos.y*e.gridSize:t.pos.y>=e.map.mapHeight-a/2?this.canvas.height-(e.map.mapHeight-t.pos.y)*e.gridSize:this.canvas.height/2}}},{key:"renderWorld",value:function(e){this.ctx.fillStyle=t.BgColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=t.FloorColor,this.ctx.fillRect(0,0,e.map.mapWidth*e.gridSize,e.map.mapHeight*e.gridSize)}},{key:"renderSpawn",value:function(e,i,a){var n=Math.ceil(this.canvas.width/e.gridSize),s=Math.ceil(this.canvas.height/e.gridSize),c=r.SpawnX-e.player.pos.x,o=r.SpawnY-e.player.pos.y;Math.abs(c)<n&&Math.abs(o)<s&&(this.ctx.fillStyle=t.SpawnColor,this.ctx.fillRect(i+c*e.gridSize,a+o*e.gridSize,r.SpawnLength*e.gridSize,r.SpawnLength*e.gridSize))}},{key:"renderPlayer",value:function(e,i,a){this.ctx.fillStyle=t.NameColor,this.ctx.font="25px Arial";var r=this.ctx.measureText(e.player.name).width;this.ctx.fillText(e.player.name,i-r/2+e.gridSize/2,a-e.gridSize/2),this.ctx.fillStyle=t.PlayerColor,this.ctx.fillRect(i,a,e.gridSize,e.gridSize)}},{key:"renderPlayers",value:function(e,i,a){var r=this,n=Math.ceil(this.canvas.width/e.gridSize),s=Math.ceil(this.canvas.height/e.gridSize);e.players.forEach((function(c){var o=c.pos.x-e.player.pos.x,l=c.pos.y-e.player.pos.y;if(Math.abs(o)<n&&Math.abs(l)<s){r.ctx.fillStyle=t.NameColor,r.ctx.font="25px Arial";var h=r.ctx.measureText(c.name).width;r.ctx.fillText(c.name,i+o*e.gridSize-h/2+e.gridSize/2,a+l*e.gridSize-e.gridSize/2),r.ctx.fillStyle=t.PlayersColor,r.ctx.fillRect(i+o*e.gridSize,a+l*e.gridSize,e.gridSize,e.gridSize)}}))}},{key:"renderCrawlers",value:function(e,i,a){var r=this,n=Math.ceil(this.canvas.width/e.gridSize),s=Math.ceil(this.canvas.height/e.gridSize);e.crawlers.forEach((function(c){var o=c.pos.x-e.player.pos.x,l=c.pos.y-e.player.pos.y;Math.abs(o)<n&&Math.abs(l)<s&&(r.ctx.fillStyle=t.CrawlerColor,r.ctx.fillRect(i+o*e.gridSize,a+l*e.gridSize,e.gridSize,e.gridSize))}))}},{key:"renderItems",value:function(e,i,a){var r=this,n=Math.ceil(this.canvas.width/e.gridSize),s=Math.ceil(this.canvas.height/e.gridSize);e.items.forEach((function(c){var o=c.pos.x-e.player.pos.x,l=c.pos.y-e.player.pos.y;Math.abs(o)<n&&Math.abs(l)<s&&(r.ctx.fillStyle=t.ItemColor,r.ctx.fillRect(i+o*e.gridSize,a+l*e.gridSize,e.gridSize,e.gridSize))}))}}])&&n(i.prototype,a),s&&n(i,s),e}();function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){h(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var y=io("/"),d=document.getElementById("game-screen"),p=document.getElementById("form-screen"),u=document.getElementById("nickname-form"),f=document.getElementById("username-input");u.addEventListener("submit",(function(e){e.preventDefault(),p.style.display="none",d.style.display="block",y.emit("playerInit","".concat(f.value)),y.on("staticState",(function(e){return new g(e).init()}))}));var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"controls",a.getInstance()),h(this,"renderer",s.getInstance()),h(this,"dynamicState",{players:[],items:[],crawlers:[]}),this.staticState=t}var t,i;return t=e,(i=[{key:"init",value:function(){this.controls.init(y),this.renderer.init(),y.on("dynamicState",this.onDynamicStateChange.bind(this))}},{key:"onDynamicStateChange",value:function(e){var t=this;console.log(e),this.dynamicState?(this.dynamicState=o(o({},this.dynamicState),{},{player:e.player}),e.hasOwnProperty("players")&&(this.dynamicState=o(o({},this.dynamicState),{},{players:e.players})),e.hasOwnProperty("items")&&(this.dynamicState=o(o({},this.dynamicState),{},{items:e.items})),e.hasOwnProperty("crawlers")&&(this.dynamicState=o(o({},this.dynamicState),{},{crawlers:e.crawlers}))):this.dynamicState=e,requestAnimationFrame((function(){return t.renderer.renderGame(o(o({},t.staticState),t.dynamicState))}))}}])&&l(t.prototype,i),e}()})()})();
//# sourceMappingURL=bundle.js.map