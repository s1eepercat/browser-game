(()=>{var e={176:e=>{e.exports={PlayerSpeed:1,CrosshairDistance:20,CrosshairOffset:1.5,CrosshairDashes:5,CrosshairDashGaps:15,CanvasW:.7,CanvasH:.8,FrameRate:30,GridSize:30,MapWidth:140,MapHeight:140,SpawnX:3,SpawnY:3,SpawnSize:10,ItemAmountPerPlayer:10,CrawlersPerPlayer:150,CrawlersSpawnDistance:25}}},r={};function t(i){var a=r[i];if(void 0!==a)return a.exports;var n=r[i]={exports:{}};return e[i](n,n.exports,t),n.exports}(()=>{"use strict";function e(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r,i=function(){function r(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,r)}var t,i,a;return t=r,a=[{key:"getInstance",value:function(){return r.instance||(r.instance=new r),r.instance}}],(i=[{key:"init",value:function(e){this.initMovement(e)}},{key:"initMovement",value:function(e){var r=0,t=0,i=0,a=0;document.addEventListener("keydown",(function(n){switch(n.key){case"a":r=-1;break;case"d":t=1;break;case"w":i=-1;break;case"s":a=1}e.emit("velocityChange",{x:r+t,y:i+a})})),document.addEventListener("keyup",(function(n){switch(n.key){case"a":r=0;break;case"d":t=0;break;case"w":i=0;break;case"s":a=0}e.emit("velocityChange",{x:r+t,y:i+a})}))}}])&&e(t.prototype,i),a&&e(t,a),r}(),a=t(176);function n(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e){e.CrosshairColor="#231f20",e.FloorColor="#93c09e",e.SpawnColor="#767676",e.PlayerColor="#006a4e",e.PlayersColor="#136185",e.ItemColor="#e66916",e.NameColor="#F0FFF0",e.CrawlerColor="#AA4A44"}(r||(r={}));var s=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,s;return t=e,s=[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}],(i=[{key:"init",value:function(){return this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=window.innerWidth*a.CanvasW,this.canvas.height=window.innerHeight*a.CanvasH,{gridW:Math.floor(this.canvas.width/a.GridSize),gridH:Math.floor(this.canvas.height/a.GridSize)}}},{key:"renderGame",value:function(e){var r=this.getPlayerPosition(e),t=r.playerX,i=r.playerY;this.renderWorld(),this.renderSpawn(e,t,i),this.renderPlayer(e,t,i),this.renderPlayers(e,t,i),this.renderCrawlers(e,t,i),this.renderItems(e,t,i)}},{key:"getPlayerPosition",value:function(e){var r=e.player,t=Math.ceil(this.canvas.width/a.GridSize),i=Math.ceil(this.canvas.height/a.GridSize);return{playerX:r.pos.x<=t/2?r.pos.x*a.GridSize:r.pos.x>=a.MapWidth-t/2?this.canvas.width-(a.MapWidth-r.pos.x)*a.GridSize:this.canvas.width/2,playerY:r.pos.y<=i/2?r.pos.y*a.GridSize:r.pos.y>=a.MapHeight-i/2?this.canvas.height-(a.MapHeight-r.pos.y)*a.GridSize:this.canvas.height/2}}},{key:"renderWorld",value:function(){this.ctx.fillStyle=r.FloorColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"renderSpawn",value:function(e,t,i){var n=Math.ceil(this.canvas.width/a.GridSize),s=Math.ceil(this.canvas.height/a.GridSize),o=a.SpawnX-e.player.pos.x,c=a.SpawnY-e.player.pos.y;Math.abs(o)<n&&Math.abs(c)<s&&(this.ctx.fillStyle=r.SpawnColor,this.ctx.fillRect(t+o*a.GridSize,i+c*a.GridSize,a.SpawnSize*a.GridSize,a.SpawnSize*a.GridSize))}},{key:"renderPlayer",value:function(e,t,i){var n=this,s=e.player;this.ctx.fillStyle=r.NameColor,this.ctx.font="25px Arial";var o=this.ctx.measureText(s.name).width;this.ctx.fillText(s.name,t-o/2+a.GridSize/2,i-a.GridSize/2),this.ctx.fillStyle=r.PlayerColor,this.ctx.fillRect(t,i,a.GridSize,a.GridSize),!e.crawlers||e.player.pos.x>=a.SpawnX&&e.player.pos.x<=a.SpawnX+a.SpawnSize&&e.player.pos.y>=a.SpawnY&&e.player.pos.y<=a.SpawnY+a.SpawnSize||e.crawlers.forEach((function(e){Math.abs(s.pos.x-e.pos.x)>a.CrosshairDistance&&Math.abs(s.pos.y-e.pos.y)>a.CrosshairDistance||(e.pos.x>s.pos.x&&s.pos.y===e.pos.y&&(n.ctx.strokeStyle=r.CrosshairColor,n.ctx.setLineDash([a.CrosshairDashes,a.CrosshairDashGaps]),n.ctx.beginPath(),n.ctx.moveTo(t+a.CrosshairOffset*a.GridSize,i+a.GridSize/2),n.ctx.lineTo(t+a.CrosshairDistance*a.GridSize,i+a.GridSize/2),n.ctx.stroke()),e.pos.x<s.pos.x&&s.pos.y===e.pos.y&&(n.ctx.strokeStyle=r.CrosshairColor,n.ctx.setLineDash([a.CrosshairDashes,a.CrosshairDashGaps]),n.ctx.beginPath(),n.ctx.moveTo(t-a.CrosshairOffset*a.GridSize+a.GridSize,i+a.GridSize/2),n.ctx.lineTo(t-a.CrosshairDistance*a.GridSize+a.GridSize,i+a.GridSize/2),n.ctx.stroke()),e.pos.y>s.pos.y&&s.pos.x===e.pos.x&&(n.ctx.strokeStyle=r.CrosshairColor,n.ctx.setLineDash([a.CrosshairDashes,a.CrosshairDashGaps]),n.ctx.beginPath(),n.ctx.moveTo(t+a.GridSize/2,i+a.CrosshairOffset*a.GridSize),n.ctx.lineTo(t+a.GridSize/2,i+a.CrosshairDistance*a.GridSize),n.ctx.stroke()),e.pos.y<s.pos.y&&s.pos.x===e.pos.x&&(n.ctx.strokeStyle=r.CrosshairColor,n.ctx.setLineDash([a.CrosshairDashes,a.CrosshairDashGaps]),n.ctx.beginPath(),n.ctx.moveTo(t+a.GridSize/2,i-a.CrosshairOffset*a.GridSize+a.GridSize),n.ctx.lineTo(t+a.GridSize/2,i-a.CrosshairDistance*a.GridSize+a.GridSize),n.ctx.stroke()))}))}},{key:"renderPlayers",value:function(e,t,i){var n=this;e.hasOwnProperty("players")&&e.players.forEach((function(s){var o=s.pos.x-e.player.pos.x,c=s.pos.y-e.player.pos.y;n.ctx.fillStyle=r.NameColor,n.ctx.font="25px Arial";var l=n.ctx.measureText(s.name).width;n.ctx.fillText(s.name,t+o*a.GridSize-l/2+a.GridSize/2,i+c*a.GridSize-a.GridSize/2),n.ctx.fillStyle=r.PlayersColor,n.ctx.fillRect(t+o*a.GridSize,i+c*a.GridSize,a.GridSize,a.GridSize)}))}},{key:"renderCrawlers",value:function(e,t,i){var n=this;e.hasOwnProperty("crawlers")&&e.crawlers.forEach((function(s){var o=s.pos.x-e.player.pos.x,c=s.pos.y-e.player.pos.y;n.ctx.fillStyle=r.CrawlerColor,n.ctx.fillRect(t+o*a.GridSize,i+c*a.GridSize,a.GridSize,a.GridSize)}))}},{key:"renderItems",value:function(e,t,i){var n=this;e.hasOwnProperty("items")&&e.items.forEach((function(s){var o=s.pos.x-e.player.pos.x,c=s.pos.y-e.player.pos.y;n.ctx.fillStyle=r.ItemColor,n.ctx.fillRect(t+o*a.GridSize,i+c*a.GridSize,a.GridSize,a.GridSize)}))}}])&&n(t.prototype,i),s&&n(t,s),e}();function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){h(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function h(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var p=document.getElementById("game-screen"),y=document.getElementById("form-screen"),d=document.getElementById("nickname-form"),u=document.getElementById("username-input");d.addEventListener("submit",(function(e){return(new f).init(e)}));var f=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"controls",i.getInstance()),h(this,"renderer",s.getInstance())}var r,t;return r=e,(t=[{key:"init",value:function(e){var r=this;e.preventDefault(),y.style.display="none",p.style.display="block";var t=io("/");this.controls.init(t);var i=this.renderer.init();t.emit("playerInit",{name:u.value,canvasSize:i}),t.on("staticState",(function(e){return r.staticState=e})),t.on("dynamicState",this.onDynamicStateChange.bind(this))}},{key:"onDynamicStateChange",value:function(e){var r=this;console.log(e),requestAnimationFrame((function(){return r.renderer.renderGame(c(c({},r.staticState),e))}))}}])&&l(r.prototype,t),e}()})()})();
//# sourceMappingURL=bundle.js.map